<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultra-Fast DNI Test Page</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
        .test-container { max-width: 600px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; }
        .phone-number { font-size: 2rem; color: #3498db; font-weight: bold; margin: 20px 0; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üöÄ Ultra-Fast DNI Test</h1>
        <p>Testing the new ultra-fast DNI endpoint with sub-50ms response times:</p>
        
        <div class="phone-number tracking-number">(555) 123-4567</div>
        
        <div id="status" class="status info">Initializing ultra-fast DNI system...</div>
        <div id="performance" class="status info">Waiting for response...</div>
    </div>

    <script>
    (function() {
        'use strict';
        
        const statusDiv = document.getElementById('status');
        const performanceDiv = document.getElementById('performance');
        const startTime = Date.now();
        
        console.log('üöÄ Ultra-Fast DNI Test Starting...');
        statusDiv.textContent = 'üöÄ Ultra-Fast DNI Test Starting...';
        
        const requestData = {
            campaignId: 'b14514dc-b985-4790-a6e1-fd2d8db5467e'
        };
        
        console.log('üì° Sending ultra-fast request:', requestData);
        
        fetch('/api/dni/ultra-fast', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestData)
        })
        .then(response => {
            const networkTime = Date.now() - startTime;
            console.log('üìà Response status:', response.status, 'Network time:', networkTime + 'ms');
            statusDiv.textContent = `üì° Response received in ${networkTime}ms`;
            statusDiv.className = 'status success';
            return response.json();
        })
        .then(data => {
            const totalTime = Date.now() - startTime;
            console.log('‚ö° Ultra-fast DNI success:', data);
            
            // Update phone number
            const phoneElement = document.querySelector('.tracking-number');
            if (data.phoneNumber && data.formattedNumber) {
                phoneElement.textContent = data.formattedNumber;
                phoneElement.style.color = '#27ae60';
                statusDiv.textContent = `‚úÖ Phone number replaced: ${data.formattedNumber}`;
                performanceDiv.textContent = `‚ö° Server response: ${data.responseTime} | Total network: ${totalTime}ms`;
                performanceDiv.className = 'status success';
            } else {
                statusDiv.textContent = '‚ùå No phone number received';
                statusDiv.className = 'status error';
            }
        })
        .catch(error => {
            const totalTime = Date.now() - startTime;
            console.error('‚ùå Ultra-fast DNI Error:', error);
            statusDiv.textContent = `‚ùå Error: ${error.message}`;
            statusDiv.className = 'status error';
            performanceDiv.textContent = `‚è±Ô∏è Failed after ${totalTime}ms`;
            performanceDiv.className = 'status error';
        });
    })();
    </script>
</body>
</html>